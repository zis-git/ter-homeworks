# Домашнее задание к занятию «Введение в Terraform» Голоха Е.В.



### Задание 1

1. Перейдите в каталог [**src**](https://github.com/netology-code/ter-homeworks/tree/main/01/src). Скачайте все необходимые зависимости, использованные в проекте. 
2. Изучите файл **.gitignore**. В каком terraform-файле, согласно этому .gitignore, допустимо сохранить личную, секретную информацию?(логины,пароли,ключи,токены итд)
3. Выполните код проекта. Найдите  в state-файле секретное содержимое созданного ресурса **random_password**, пришлите в качестве ответа конкретный ключ и его значение.
4. Раскомментируйте блок кода, примерно расположенный на строчках 29–42 файла **main.tf**.
Выполните команду ```terraform validate```. Объясните, в чём заключаются намеренно допущенные ошибки. Исправьте их.
5. Выполните код. В качестве ответа приложите: исправленный фрагмент кода и вывод команды ```docker ps```.
6. Замените имя docker-контейнера в блоке кода на ```hello_world```. Не перепутайте имя контейнера и имя образа. Мы всё ещё продолжаем использовать name = "nginx:latest". Выполните команду ```terraform apply -auto-approve```.
Объясните своими словами, в чём может быть опасность применения ключа  ```-auto-approve```. Догадайтесь или нагуглите зачем может пригодиться данный ключ? В качестве ответа дополнительно приложите вывод команды ```docker ps```.
8. Уничтожьте созданные ресурсы с помощью **terraform**. Убедитесь, что все ресурсы удалены. Приложите содержимое файла **terraform.tfstate**. 
9. Объясните, почему при этом не был удалён docker-образ **nginx:latest**. Ответ **ОБЯЗАТЕЛЬНО НАЙДИТЕ В ПРЕДОСТАВЛЕННОМ КОДЕ**, а затем **ОБЯЗАТЕЛЬНО ПОДКРЕПИТЕ** строчкой из документации [**terraform провайдера docker**](https://docs.comcloud.xyz/providers/kreuzwerker/docker/latest/docs).  (ищите в классификаторе resource docker_image )

### Решение 1

1. Инициализация Terraform

В каталоге проекта был выполнен terraform init.
Результат: Terraform успешно инициализирован, плагины провайдера установлены.

<img width="673" height="216" alt="Снимок экрана 2025-10-25 в 19 02 33" src="https://github.com/user-attachments/assets/084dfe9c-edac-4b53-99ad-339a1d23f26a" />

2. Проверка форматирования и валидации

Выполнены команды:

terraform fmt -check
terraform validate
Результат: Конфигурация корректна и соответствует форматированию.

<img width="366" height="85" alt="Снимок экрана 2025-10-25 в 19 05 00" src="https://github.com/user-attachments/assets/5dcfc4bc-f949-4dfd-ae1a-e99d813c5774" />

3. Планирование изменений

Выполнена команда:
terraform plan
Terraform определил создание ресурса с выводом hello = (known after apply).

<img width="682" height="211" alt="Снимок экрана 2025-10-25 в 19 05 51" src="https://github.com/user-attachments/assets/a7aaadd1-5ede-4e16-b006-b5e5c90d1da5" />
4. Применение конфигурации

<img width="661" height="207" alt="Снимок экрана 2025-10-25 в 19 07 07" src="https://github.com/user-attachments/assets/9ceb3c65-abde-4ede-b7ab-fc11b46c6e5b" />

5. Проверка Docker окружения
<img width="677" height="542" alt="Снимок экрана 2025-10-25 в 19 56 12" src="https://github.com/user-attachments/assets/0458fa3d-9478-40d7-b3ae-bac75df9a2e4" />

<img width="550" height="84" alt="Снимок экрана 2025-10-25 в 19 58 05" src="https://github.com/user-attachments/assets/a5f38227-52f2-46c4-8774-b76c34faca27" />

6. Создание инфраструктуры Docker через Terraform
<img width="648" height="243" alt="Снимок экрана 2025-10-25 в 20 00 54" src="https://github.com/user-attachments/assets/13f4ea24-0ac3-4553-acd7-07dc7275e713" />
инициализация терраформ
<img width="607" height="228" alt="Снимок экрана 2025-10-25 в 20 17 26" src="https://github.com/user-attachments/assets/089b553c-deba-4ce6-bcde-0bfd815746e0" />
Применение конфигурации:

<img width="680" height="544" alt="Снимок экрана 2025-10-28 в 11 30 53" src="https://github.com/user-attachments/assets/9f11be12-7625-4a0e-9b5f-1b1c8ef1781d" />

Проверка результата пароля в состоянии Terraform:

<img width="434" height="61" alt="Снимок экрана 2025-10-28 в 11 33 50" src="https://github.com/user-attachments/assets/779c887a-ae51-45fc-a55e-538d57a821da" />

На этапе добавления контейнера были выявлены ошибки конфигурации main.tf:

отсутствие имени ресурса;

некорректное имя контейнера;

ссылка на несуществующий ресурс.

<img width="675" height="267" alt="Снимок экрана 2025-10-28 в 11 41 42" src="https://github.com/user-attachments/assets/f535a047-bdfc-400f-8863-357664d7bf39" />

<img width="674" height="200" alt="Снимок экрана 2025-10-28 в 11 43 10" src="https://github.com/user-attachments/assets/d1995b26-453e-45b9-b983-3b739036db8d" />

После исправлений конфигурация успешно валидирована:

<img width="677" height="87" alt="Снимок экрана 2025-10-28 в 11 43 51" src="https://github.com/user-attachments/assets/ca129bd7-964e-48da-9533-152cd96469bc" />

Применение конфигурации — создан Docker-образ и контейнер nginx:
<img width="686" height="272" alt="Снимок экрана 2025-10-28 в 11 45 21" src="https://github.com/user-attachments/assets/83213b44-fa4d-4782-bf27-5a2fa6d3185a" />

Проверка активного контейнера:
<img width="681" height="91" alt="Снимок экрана 2025-10-28 в 11 46 11" src="https://github.com/user-attachments/assets/006bdbeb-91ae-4616-8718-83d99eb573c3" />

Изменение имени контейнера и повторное применение конфигурации:

<img width="682" height="145" alt="Снимок экрана 2025-10-28 в 11 48 25" src="https://github.com/user-attachments/assets/791963c5-5349-444e-8e54-fc98f1dadd33" />

Проверка docker ps — запущен контейнер hello_world

<img width="675" height="85" alt="Снимок экрана 2025-10-28 в 11 49 33" src="https://github.com/user-attachments/assets/cec7b909-4112-4cb0-9c99-78a7c2cace8e" />

7. Удаление инфраструктуры

Все ресурсы (контейнер, образ и random_password) удалены успешно.
Проверено содержимое terraform.tfstate — ресурсы отсутствуют.

<img width="678" height="146" alt="Снимок экрана 2025-10-28 в 11 50 30" src="https://github.com/user-attachments/assets/55aa9d16-220c-4863-8c9f-d60f88371625" />

<img width="569" height="157" alt="Снимок экрана 2025-10-28 в 11 51 02" src="https://github.com/user-attachments/assets/94fed723-2a93-476e-8543-4c47182171fa" />

<img width="536" height="165" alt="Снимок экрана 2025-10-28 в 11 52 18" src="https://github.com/user-attachments/assets/da898df8-cfc8-4e1e-b650-0e2544b12201" />


8. Объяснение

После выполнения команды terraform destroy локальный Docker-образ nginx:latest не удалился.
Причина — в конфигурации ресурса:

resource "docker_image" "nginx" {
  name         = "nginx:latest"
  keep_locally = true
}

Параметр keep_locally = true означает, что образ не будет удалён при уничтожении ресурса Terraform.
Если бы параметр был false, образ удалился бы вместе с контейнером.
